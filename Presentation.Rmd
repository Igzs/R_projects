---
title: "Pitch Presentation"
author: "Arthur LAUREAU - Igor FIDALGO"
date: "November 28, 2019"
output: slidy_presentation
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## 1. Introduction

### **The Shiny Application project**:

This project is a simple hello world project to learn how to make a **Shiny app** and a related **presentation** using **RStudio**.
To learn more, see [our github](https://github.com/Igzs/R_shiny_pres).  

## 2. Dataset summary

The **UCBAdmissions** data set is frequently used for illustrating **Simpson's paradox**, see [Bickel et al (1975)](http://www.jstor.org/stable/1739581). At issue is whether the data show evidence of sex bias in admission practices.  

The UCBAdmissions data set is 3-dimensional array resulting from cross-tabulating 4526 observations on 3 variables. The variables and their levels are as follows: 

| No   |  Name  |       Levels       |
|:----:|:------:|:------------------:|
|   1  |  Admit | Admitted, Rejected |
|   2  | Gender |    Male, Female    |
|   2  |  Dept  |     A,B,C,D,E,F    |
  
  
```{r UCBAdmissions}
summary(UCBAdmissions)
```

## 3. Functionalities

- Navbar architecture
-- Documentation included in the app
- Different graphs 
-- Mosaic plot and pie charts
- Compare results
-- Highlight Simpson's Paradox

## 4. Interactive Plot

```{r message=FALSE, warning=FALSE}
library(ggplot2)
library(ggmosaic)
library(dplyr)
inputPanel(
  radioButtons("gender", "Gender:",c("Male","Female"))
  
)

renderPlot({
  df_ucba <- tbl_df(UCBAdmissions)
  df_ucba <- df_ucba %>% filter(Gender== input$gender)
  #retrieve the total in a variable
  total <- as.integer(df_ucba %>% summarise(sum(n)))
  df_plot <- df_ucba %>% group_by(Admit,Gender)  %>% mutate(Percent = (n/total)*100) %>% summarise(Percent = sum(Percent))
   ggplot(df_plot, aes(x="", y=Percent, fill=Admit))+
          geom_bar(width = 1, stat = "identity") + 
          #transform the barplot into a pie chart
          coord_polar("y", start=0) + 
          #percentage labels inside the pie chart
          geom_text(aes(label=Percent),color='white',position = position_stack(vjust = 0.5)) + 
          #labels
          labs(title = paste("Percentage of",input$gender,"admissions"),
               y = "Admission percentage") +
          #colors
          scale_fill_manual(values=c("#56B4E9", "#D46A6A"))
})
```